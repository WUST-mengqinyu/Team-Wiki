



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://wiki.verly-badcw.top/Training Logs/2020 Wannafly Winter Camp/day1/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../..">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.5.1">
    
    
      
        <title>Day1 - Team Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.82a18eb7.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.3e3d1dff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono&display=fallback">
        <style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-139418303-1", "wiki.verly-badcw.top")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#_1" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://wiki.verly-badcw.top" title="Team Wiki" class="md-header-nav__button md-logo">
          
            <i class="md-icon">cloud</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Team Wiki
            </span>
            <span class="md-header-nav__topic">
              
                Day1
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../.." class="md-tabs__link">
          主页
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Personal Page/Verly/" class="md-tabs__link">
          个人页面
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../About/About/" class="md-tabs__link">
          关于
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://wiki.verly-badcw.top" title="Team Wiki" class="md-nav__button md-logo">
      
        <i class="md-icon">cloud</i>
      
    </a>
    Team Wiki
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      主页
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        主页
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../.." title="2019赛季" class="md-nav__link">
      2019赛季
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Wannafly Winter Camp 2020/" title="Wannafly Winter Camp" class="md-nav__link">
      Wannafly Winter Camp
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      个人页面
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        个人页面
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Personal Page/Verly/" title="Verly" class="md-nav__link">
      Verly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Personal Page/badcw/" title="badcw" class="md-nav__link">
      badcw
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      关于
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        关于
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../About/About/" title="About" class="md-nav__link">
      About
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <p>总之没有什么盐分，强调安全问题</p>
<h2 id="_1">下午比赛<a class="headerlink" href="#_1" title="Permanent link">Link</a></h2>
<p>签到飞快，2 题 rank1，最后一小时回去收拾东西然后鸽了，走的时候 rank8，最后 rank12</p>
<table>
<thead>
<tr>
<th>Name</th>
<th align="center">Date</th>
<th align="center">Solved</th>
<th align="center">A</th>
<th align="center">B</th>
<th align="center">C</th>
<th align="center">D</th>
<th align="center">E</th>
<th align="center">F</th>
<th align="center">G</th>
<th align="center">H</th>
<th align="center">I</th>
<th align="center">J</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://codeforces.com/group/6QKpZkKhsL/contest/265753">2020 CCPC Wannafly Winter Camp Day1 (Div.1&amp;2)</a></td>
<td align="center">2020/1/12</td>
<td align="center">7/10</td>
<td align="center">O</td>
<td align="center">O</td>
<td align="center">O</td>
<td align="center">.</td>
<td align="center">O</td>
<td align="center">O</td>
<td align="center">.</td>
<td align="center">O</td>
<td align="center">O</td>
<td align="center">.</td>
</tr>
</tbody>
</table>
<h2 id="to-do-list">To-do list<a class="headerlink" href="#to-do-list" title="Permanent link">Link</a></h2>
<p><code>E</code></p>
<h2 id="a">A. 期望逆序对<a class="headerlink" href="#a" title="Permanent link">Link</a></h2>
<p>求一个排列，排序一个区间对使得期望逆序对最少求期望。即对于 <span><span class="MathJax_Preview">[l_i,r_i]</span><script type="math/tex">[l_i,r_i]</script></span> 中的任何一个整数 <span><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span>，<span><span class="MathJax_Preview">x_i=j</span><script type="math/tex">x_i=j</script></span>的概率都是 <span><span class="MathJax_Preview">(r_i-l_i+1)^{-1}</span><script type="math/tex">(r_i-l_i+1)^{-1}</script></span></p>
<p>显然，对于两个区间 <span><span class="MathJax_Preview">[a,b]</span><script type="math/tex">[a,b]</script></span> 和 <span><span class="MathJax_Preview">[c,d]</span><script type="math/tex">[c,d]</script></span>。若 <span><span class="MathJax_Preview">a + b &lt; c + d</span><script type="math/tex">a + b < c + d</script></span>，显然  <span><span class="MathJax_Preview">[a,b]</span><script type="math/tex">[a,b]</script></span> 应该在 <span><span class="MathJax_Preview">[c,d]</span><script type="math/tex">[c,d]</script></span> 前面然后由于这个东西是单向有可传递性的所以直接对区间按权排序，然后计算期望即可</p>
<p>由于 <span><span class="MathJax_Preview">n\le 5\cdot 10^3</span><script type="math/tex">n\le 5\cdot 10^3</script></span> 计算期望的方法是对于每个点对求它可能是逆序对的期望然后求和即可</p>
<p>所以本题考虑清楚每个点对的期望即可</p>
<details class="note"><summary>Code</summary><pre class="codehilite"><code class="language-cpp linenums">/*================================================================
*   Copyright (C) 2019 Sangfor Ltd. All rights reserved.
*
*   创 建 者： badcw
*   创建日期： 2020/1/12
*
================================================================*/
#include &lt;bits/stdc++.h&gt;

#define ll long long
using namespace std;

const int maxn = 5e3+50;
const int mod = 998244353;
ll qp(ll a, ll n) {
    ll res = 1;
    while (n &gt; 0) {
        if (n &amp; 1) res = res * a % mod;
        a = a * a % mod;
        n &gt;&gt;= 1;
    }
    return res;
}

template &lt;class T&gt;
inline bool scan(T&amp; ret) {
    char c;
    int sgn;
    if (c = getchar(), c == EOF) return 0; // EOF
    while (c != '-' &amp;&amp; (c &lt; '0' || c &gt; '9')) c = getchar();
    sgn = (c == '-') ? -1 : 1;
    ret = (c == '-') ? 0 : (c - '0');
    while (c = getchar(), c &gt;= '0' &amp;&amp; c &lt;= '9') ret = ret * 10 + (c - '0');
    ret *= sgn;
    return 1;
}

//template &lt;class T&gt;
//inline void out(T x) {
//    if (x &gt; 9) out(x / 10);
//    putchar(x % 10 + '0');
//}

int n;
int l[maxn], r[maxn];
int idx[maxn];
ll inv[maxn];

ll cal(int i, int j) {
    i = idx[i], j = idx[j];
    ll a = l[i], b = r[i], c = l[j], d = r[j];
    ll res = 0;
    if (c &gt;= b) ;
    else if (c &lt;= a &amp;&amp; d &gt;= b) {
        res = (a - c) * (b - a + 1) + (b - a + 1) * (b - a) / 2;
    } else if (a &lt;= c &amp;&amp; d &lt;= b) {
        res = (b * 2 - c - d) * (d - c + 1) / 2;
    } else if (a &lt;= c &amp;&amp; d &gt;= b) {
        res = (b - c) * (b - c + 1) / 2;
    }
    return res % mod * inv[i] % mod * inv[j] % mod;
}

int main(int argc, char* argv[]) {
//    freopen("data.in", "r", stdin);
//    freopen("data.out", "w", stdout);
//    clock_t ST = clock();
    scanf("%d", &amp;n);
    for (int i = 1; i &lt;= n; ++i) {
        scanf("%d%d", &amp;l[i], &amp;r[i]), idx[i] = i;
        inv[i] = qp(r[i] - l[i] + 1, mod - 2);
    }
    sort(idx + 1, idx + 1 + n, [](int x, int y) {
        return l[x] + r[x] &lt; l[y] + r[y];
    });
    ll res = 0;
    for (int i = 1; i &lt;= n; ++i) {
        for (int j = i + 1; j &lt;= n; ++j) {
            res = (res + cal(i, j)) % mod;
        }
    }
    printf("%lld\n", res % mod);
//    cerr &lt;&lt; "time: " &lt;&lt; ((clock() - ST) * 1000.0 / CLOCKS_PER_SEC) &lt;&lt; "ms" &lt;&lt; endl;
    return 0;
}</code></pre>

</details>
<h2 id="b">B. 密码学<a class="headerlink" href="#b" title="Permanent link">Link</a></h2>
<p>有个加模的加密方法，输入加密 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 次后每个串的形式，求原串</p>
<p>签到题，减模倒推即可</p>
<details class="note"><summary>Code</summary><pre class="codehilite"><code class="language-cpp linenums">#include &lt;bits/stdc++.h&gt;</code></pre>

<p>开营仪式using namespace std;
typedef long long ll;</p>
<p>const int maxn = 1000 + 10;
char s[maxn][110];</p>
<p>int x[maxn], y[maxn];</p>
<p>int getid(char c)
{
    if(c &gt;= &lsquo;a&rsquo; &amp;&amp; c &lt;= &lsquo;z&rsquo;) return c - &lsquo;a&rsquo;;
    if(c &gt;= &lsquo;A&rsquo; &amp;&amp; c &lt;= &lsquo;z&rsquo;) return c - &lsquo;A&rsquo; + 26;
}</p>
<p>int getch(int c)
{
    if(c &gt;= 0 &amp;&amp; c &lt;= 25) return c + &lsquo;a&rsquo;;
    return c - 26 + &lsquo;A&rsquo;;
}</p>
<p>int len[maxn];</p>
<p>int main()
{
    int n, m;
    scanf(&ldquo;%d%d&rdquo;, &amp;n, &amp;m);
    for(int i = 1; i &lt;= m; i ++)
        scanf(&ldquo;%d%d&rdquo;, &amp;x[i], &amp;y[i]);
    for(int i = 1; i &lt;= n; i ++) 
    {
        scanf(&ldquo;%s&rdquo;, s[i]);
        len[i] = strlen(s[i]);
    }
    for(int i = m; i &gt;= 1; i &ndash;)
    {
        int nx = x[i], ny = y[i], lenx = len[nx], leny = len[ny];
        for(int i = 0; s[ny][i]; i ++)
        {
            char a = s[nx][i % lenx], b = s[ny][i];
            int z = (getid(b) + 52 - getid(a)) % 52;
            s[ny][i] = getch(z);
        }
    }
    for(int i = 1; i &lt;= n; i ++) printf(&ldquo;%s\n&rdquo;, s[i]);
    return 0;
}</p>
<p>```</p>
</details>
<h2 id="c">C. 染色图<a class="headerlink" href="#c" title="Permanent link">Link</a></h2>
<p>令 <span><span class="MathJax_Preview">g(n,k)</span><script type="math/tex">g(n,k)</script></span> 为 <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 个点的无向图对点染成 <span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> 种颜色最多的边数，求 <span><span class="MathJax_Preview">\sum_{i=l}^{r} g(n,i)</span><script type="math/tex">\sum_{i=l}^{r} g(n,i)</script></span>
<script type="math/tex; mode=display">
ans=n^2-\sum_{i=l}^r{(\lceil\frac{n}{i}\rceil)}^2\cdot(n\%i)+{\lfloor\frac{n}{i}\rfloor}^2\cdot(i-n\%i)
</script>
</p>
<p>对该式分块，当<span><span class="MathJax_Preview">i\le\sqrt{n}</span><script type="math/tex">i\le\sqrt{n}</script></span>时对每个点单点求值，当<span><span class="MathJax_Preview">i\ge\sqrt{n}</span><script type="math/tex">i\ge\sqrt{n}</script></span>时对<span><span class="MathJax_Preview">\lfloor\frac{n}{i}\rfloor</span><script type="math/tex">\lfloor\frac{n}{i}\rfloor</script></span>分块求和，其中<span><span class="MathJax_Preview">\sum_{i=l}^ri</span><script type="math/tex">\sum_{i=l}^ri</script></span>和<span><span class="MathJax_Preview">n\%i</span><script type="math/tex">n\%i</script></span>均为等差数列，而<span><span class="MathJax_Preview">\lfloor\frac{n}{i}\rfloor</span><script type="math/tex">\lfloor\frac{n}{i}\rfloor</script></span>在单个块内相等，每次求<span><span class="MathJax_Preview">l-1,r</span><script type="math/tex">l-1,r</script></span>的前缀和差分即可。</p>
<details class="note"><summary>Code</summary><pre class="codehilite"><code class="language-cpp linenums">#include &lt;bits/stdc++.h&gt;</code></pre>

<p>using namespace std;
typedef long long ll;</p>
<h1 id="define-int-ll">define int ll<a class="headerlink" href="#define-int-ll" title="Permanent link">Link</a></h1>
<p>const int mod = 998244353;</p>
<p>ll qp(ll a, ll n = mod - 2)
{
    ll ans = 1, base = a;
    while(n)
    {
        if(n &amp; 1) (ans *= base) %= mod;
        (base *= base) %= mod;
        n &gt;&gt;= 1;
    }
    return ans;
}</p>
<p>signed main()
{
    int t;
    scanf(&ldquo;%lld&rdquo;, &amp;t);
    while(t &ndash;)
    {
        ll n, l, r;
        scanf(&ldquo;%lld%lld%lld&rdquo;, &amp;n, &amp;l, &amp;r);
        int m = sqrt(n);
        ll res = 0;
        res = 1ll * n * n % mod * (r - l + 1) % mod;
        if(m &gt; r) m = r;
        for(int i = l; i &lt;= m; i ++)
        {
            res = (res - (n / i + 1) * (n / i + 1) % mod * (n % i) % mod + mod - (n / i) * (n / i) % mod * (i - n % i) % mod + mod) % mod;
        }
        if(m &lt; l - 1) m = l - 1;
        int x = n / (m + 1), posl = m + 1;
        for(int i = x; i &gt;= 1 &amp;&amp; posl &lt;= r; i &ndash;)
        {
            int posr = n / i;
            if(posr &gt; r) posr = r;
            ll a = n % posl, b = n % posr;
            ll left = (a + b) * (posr - posl + 1) % mod * qp(2) % mod;
            ll right = ((posl + posr) * (posr - posl + 1) % mod * qp(2) % mod - left + mod) % mod;
            res = (res - 1ll * (i + 1) * (i + 1)  % mod * left % mod + mod - 1ll * i * i % mod * right % mod + mod) % mod;
            posl = posr + 1;
            if(posr == r) break;
        }
        res = res * qp(2) % mod;
        printf(&ldquo;%lld\n&rdquo;, res);
    }
    return 0;
}
```</p>
</details>
<h2 id="e">E. 树与路径<a class="headerlink" href="#e" title="Permanent link">Link</a></h2>
<details class="note"><summary>Code</summary><pre class="codehilite"><code class="language-cpp linenums">#include &lt;bits/stdc++.h&gt;
using namespace std;
const int N=500010;
typedef long long LL;
int n,m;
struct edge{
    int b,nt;
}e[N*2];

int p[N],nn;
int fa[N][32];
LL f[N],g[N],h[N];
void anode(int x,int y){
    nn++;e[nn].b=y;e[nn].nt=p[x];p[x]=nn;
    swap(x,y);
    nn++;e[nn].b=y;e[nn].nt=p[x];p[x]=nn;
}
int deep[N];
void dfsLCA(int x,int ff=-1,int dd=0){
    for(int i=1;(1&lt;&lt;i)&lt;=dd;i++){
        fa[x][i]=fa[ fa[x][i-1] ][i-1];
    }
    deep[x]=dd;
    for(int i=p[x];i;i=e[i].nt){
        int t=e[i].b;
        if(t==ff)continue;
        fa[t][0]=x;
        dfsLCA(t,x,dd+1);
    }
}


int LCA(int x,int y){
    if(deep[x]&lt;deep[y])swap(x,y);
    int t=deep[x]-deep[y];
    for(int i=0;(1&lt;&lt;i)&lt;=t;i++)if(t&amp;(1&lt;&lt;i))x=fa[x][i];
    if(x==y)return y;
    for(int i=30;i&gt;=0;i--){
        if(fa[x][i]!=fa[y][i]){
            x=fa[x][i];
            y=fa[y][i];
        }
    } 
    return fa[x][0];
}

int findf(int x,int d){
    for(int i=0;(1&lt;&lt;i)&lt;=d;i++)if(d&amp;(1&lt;&lt;i))x=fa[x][i];
    return x;
}

LL ans[N];

void dfs1(int x){
    for(int i=p[x];i;i=e[i].nt){
        int t=e[i].b;
        if(t==fa[x][0])continue;
        dfs1(t);
        g[x]+=g[t];
        h[x]+=h[t];
    }
    g[x]+=h[x];
}

void dfs2(int x){
    for(int i=p[x];i;i=e[i].nt){
        int t=e[i].b;
        if(t==fa[x][0])continue;
        dfs2(t);
        f[x]+=f[t];
    }
    f[x]+=g[x];
}

void getAns(int x,LL now){
    ans[x]=now;
    for(int i=p[x];i;i=e[i].nt){
        int t=e[i].b;
        if(t==fa[x][0])continue;
        getAns(t,now-g[t]);
    }
}

int main(){
#ifdef WK
    freopen("in.txt","r",stdin);
#endif
    scanf("%d%d",&amp;n,&amp;m);
    for(int i=1;i&lt;n;i++){
        int aa,bb;
        scanf("%d%d",&amp;aa,&amp;bb);
        anode(aa,bb);
    }
    dfsLCA(1);
    LL asum=0;
    for(int i=1;i&lt;=m;i++){
        int aa,bb;
        scanf("%d%d",&amp;aa,&amp;bb);
        if(aa==bb)continue;
        if(fa[aa][0]==bb||fa[bb][0]==aa)continue;
        int cc=LCA(aa,bb);
        int dis=2*deep[cc]-deep[aa]-deep[bb];dis=-dis;
        if(deep[aa]&lt;deep[bb])swap(aa,bb);
        f[aa]+=dis-1;f[bb]+=dis-1;
        if(bb==cc){
            g[aa]+=dis-1;
            g[cc]+=dis-1;
            h[fa[aa][0]]-=2;
            h[cc]+=2;
        }else
        {
            g[aa]+=dis-1;
            h[fa[aa][0]]-=2;h[cc]-=2ll*(deep[aa]-deep[cc]-1)+1-dis;
            g[bb]+=dis-1;
            h[fa[bb][0]]-=2;h[cc]-=2ll*(deep[bb]-deep[cc]-1)+1-dis;
            h[cc]+=2;g[cc]-=2;
        }

        asum += 1ll*(deep[aa]-deep[cc])*(deep[bb]-deep[cc]);
    }

    dfs1(1);
    dfs2(1);
    getAns(1,asum);

    for(int i=1;i&lt;=n;i++)printf("%lld\n",ans[i]);
    return 0;
} </code></pre>

</details>
<h2 id="f">F. 乘法<a class="headerlink" href="#f" title="Permanent link">Link</a></h2>
<p>给出两个序列，求全积中第 <span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> 大的数</p>
<p>二分答案，然后对答案进行 check，每次求比当前二分的答案小的数的个数，可以考虑将 <span><span class="MathJax_Preview">B</span><script type="math/tex">B</script></span> 序列排序，枚举所有 <span><span class="MathJax_Preview">A</span><script type="math/tex">A</script></span> 套一层二分求出小于它的数的个数即可</p>
<details class="note"><summary>Code</summary><p>``` cpp</p>
<h1 id="include">include <bits/stdc++.h><a class="headerlink" href="#include" title="Permanent link">Link</a></h1>
<p>using namespace std;
const int N=100010;
typedef long long LL;
int n,m;LL k;
LL MAXN = 1000000000000000ll;
LL A[N],B[N];
int L,R;</p>
<p>int findf(int f,LL x,LL y){
    //yz=x;
    if(!f){
        LL l=1,r=m,rtn=0;
        while(l&lt;=r){
            LL mid=l+r&gt;&gt;1;
            if(B[mid]*y&gt;=x){
                rtn=mid;l=mid+1;
            }else r=mid-1;
        }
        return rtn;
    }else{
        LL l=1,r=m,rtn=m+1;
        while(l&lt;=r){
            LL mid=l+r&gt;&gt;1;
            if(B[mid]*y&gt;=x){
                rtn=mid;r=mid-1;
            }else l=mid+1;
        }
        return m-rtn+1;
    }
}</p>
<p>int check(LL x){
    LL cnt = 0;</p>
<pre class="codehilite"><code class="linenums">for(int i=1;i&lt;=n;i++){

    if(A[i]==0){
        if(x&lt;0)cnt+=m; 
    }else{
        int f = (A[i]&gt;0);

        cnt+=findf(f,x,A[i]);
    }</code></pre>


</details>
<p>​          <br />
​        }
​      <br />
        return cnt&gt;=k;
    }</p>
<pre class="codehilite"><code class="linenums">LL solve(){
    LL l=-MAXN,r=MAXN,rtn=MAXN*10;
    while(l&lt;=r){
        LL mid=l+r&gt;&gt;1;
        if(check(mid)){
            rtn=mid;l=mid+1;
        }else r=mid-1;
    }
    return rtn;
}

int main(){
#ifdef WK
    freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);
#endif
    scanf(&quot;%d%d%lld&quot;,&amp;n,&amp;m,&amp;k);
    for(int i=1;i&lt;=n;i++)scanf(&quot;%lld&quot;,&amp;A[i]);
    for(int i=1;i&lt;=m;i++)scanf(&quot;%lld&quot;,&amp;B[i]);
    sort(B+1,B+1+m);
    LL ans=solve();
    printf(&quot;%lld&quot;,ans);
    return 0;
} 
```</code></pre>


<h2 id="h">H. 最大公约数<a class="headerlink" href="#h" title="Permanent link">Link</a></h2>
<p>求 <span><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span> 使得在 <span><span class="MathJax_Preview">[1,n]</span><script type="math/tex">[1,n]</script></span> 中不存在 <span><span class="MathJax_Preview">gcd(i,k)=gcd(y,k)</span><script type="math/tex">gcd(i,k)=gcd(y,k)</script></span></p>
<p>队友一看是个大数，因为如果 <span><span class="MathJax_Preview">n=500, k=1</span><script type="math/tex">n=500, k=1</script></span> 显然是 <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 中所有的素数积</p>
<p>然后随便推一推设 <span><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 是 <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 中所有的素数集合，答案就是 <span><span class="MathJax_Preview">k \cdot \prod p</span><script type="math/tex">k \cdot \prod p</script></span></p>
<details class="note"><summary>Code</summary><pre class="codehilite"><code class="language-python linenums">T = int(input())


def prim(x):
    for i in range(2, x):
        if (x % i == 0):
            return False
    return True


for kase in range(T):
    n, k = map(int, input().split())
    ans = k
    for i in range(2, int(n / k) + 1):
        if prim(i):
            ans *= i
    print(ans)</code></pre>

</details>
<h2 id="i-k">I. K小数查询<a class="headerlink" href="#i-k" title="Permanent link">Link</a></h2>
<p>区间推平最大值 + 区间查询第 k 小</p>
<p>分块 + 二分答案复杂度可过</p>
<p>正解树套树不会写</p>
<p>另外区间推平最大值是 segment beats</p>
<details class="note"><summary>Code</summary><pre class="codehilite"><code class="language-cpp linenums">/*================================================================
*   Copyright (C) 2019 Sangfor Ltd. All rights reserved.
*
*   创 建 者： badcw
*   创建日期： 2020/1/12
*
================================================================*/
#include &lt;bits/stdc++.h&gt;

#define ll long long
using namespace std;

const int maxn = 8e4+50;
const int mod = 1e9+7;
ll qp(ll a, ll n) {
    ll res = 1;
    while (n &gt; 0) {
        if (n &amp; 1) res = res * a % mod;
        a = a * a % mod;
        n &gt;&gt;= 1;
    }
    return res;
}

template &lt;class T&gt;
inline bool scan(T&amp; ret) {
    char c;
    int sgn;
    if (c = getchar(), c == EOF) return 0; // EOF
    while (c != '-' &amp;&amp; (c &lt; '0' || c &gt; '9')) c = getchar();
    sgn = (c == '-') ? -1 : 1;
    ret = (c == '-') ? 0 : (c - '0');
    while (c = getchar(), c &gt;= '0' &amp;&amp; c &lt;= '9') ret = ret * 10 + (c - '0');
    ret *= sgn;
    return 1;
}

//template &lt;class T&gt;
//inline void out(T x) {
//    if (x &gt; 9) out(x / 10);
//    putchar(x % 10 + '0');
//}

const int maxb = 1005;
const int inf = 8e4+50;
int n, m;
int belong[maxn], lpos[maxb], rpos[maxb];
int val[maxn], lazy[maxn], op[maxb];
int block;

void rebuild(int idx) {
    for (int i = lpos[idx]; i &lt;= rpos[idx]; ++i) {
        if (val[i] &gt; op[idx]) val[i] = op[idx];
        lazy[i] = val[i];
    }
    sort(lazy + lpos[idx], lazy + rpos[idx] + 1);
//    op[idx] = inf;
}

void update(int l, int r, int w) {
    if (belong[l] == belong[r]) {
        for (int i = l; i &lt;= r; ++i) {
            if (val[i] &gt; w) val[i] = w;
        }
        rebuild(belong[l]);
        return;
    }
    for (int i = l; i &lt;= rpos[belong[l]]; ++i) {
        if (val[i] &gt; w) val[i] = w;
    }
    for (int i = belong[l] + 1; i &lt; belong[r]; ++i) {
        if (op[i] &gt; w) op[i] = w;
    }
    for (int i = lpos[belong[r]]; i &lt;= r; ++i) {
        if (val[i] &gt; w) val[i] = w;
    }
    rebuild(belong[l]), rebuild(belong[r]);
}

int sz;

void rebuild() {
    for (int i = 1; i &lt;= sz; ++i) {
        op[i] = 0;
        for (int j = lpos[i]; j &lt;= rpos[i]; ++j) {
//            if (val[j] &gt; op[i]) val[j] = op[i];
            lazy[j] = val[j];
            op[i] = max(op[i], val[j]);
        }
        sort(lazy + lpos[i], lazy + rpos[i] + 1);
//        for (int j = lpos[i]; j &lt;= rpos[i]; ++j) {
//            printf("%d ", lazy[j]);
//        }
//        printf(" | ");
    }
//    printf("\n");
}

bool check(int x, int l, int r, int w) {
    int res = 0;
    if (op[belong[l]] &lt; x) {
        res += rpos[belong[l]] - l + 1;
    } else {
        for (int i = l; i &lt;= rpos[belong[l]]; ++i) {
            if (val[i] &lt; x) res ++;
        }
    }
    for (int i = belong[l] + 1; i &lt; belong[r]; ++i) {
        if (op[i] &lt; x) res += rpos[i] - lpos[i] + 1;
        else {
            res += lower_bound(lazy + lpos[i], lazy + rpos[i] + 1, x) - lazy - lpos[i];
        }
    }
    if (op[belong[r]] &lt; x) {
        res += r - lpos[belong[r]] + 1;
    } else {
        for (int i = lpos[belong[r]]; i &lt;= r; ++i) {
            if (val[i] &lt; x) res ++;
        }
    }
    return res &lt; w;
}

int query(int l, int r, int w) {
    if (belong[l] == belong[r]) {
        vector&lt;int&gt; tmp;
        for (int i = l; i &lt;= r; ++i) {
            if (val[i] &gt; op[belong[i]]) tmp.push_back(op[belong[i]]);
            else tmp.push_back(val[i]);
        }
        sort(tmp.begin(), tmp.end());
        return tmp[w - 1];
    }
    int L = 1, R = inf;
    int res = 0;
    while (L &lt;= R) {
        int mid = L + R &gt;&gt; 1;
        if (check(mid, l, r, w)) {
            res = mid;
            L = mid + 1;
        } else {
            R = mid - 1;
        }
    }
    return res;
}

int main(int argc, char* argv[]) {
    scanf("%d%d", &amp;n, &amp;m);
//    block = n;
    block = sqrt(n);
    for (int i = 1; i &lt;= n; ++i) {
        scanf("%d", &amp;val[i]);
        lazy[i] = val[i];
        belong[i] = (i - 1) / block + 1;
    }
    sz = (n - 1) / block + 1;
    for (int i = 1; i &lt;= sz; ++i) {
        lpos[i] = 1 + (i - 1) * block;
        rpos[i] = i * block;
    }
    rpos[sz] = n;
    rebuild();
    int op, l, r, x;
    for (int i = 1; i &lt;= m; ++i) {
        scanf("%d%d%d%d", &amp;op, &amp;l, &amp;r, &amp;x);
        if (op == 1) {
            update(l, r, x);
        } else {
            printf("%d\n", query(l, r, x));
        }
    }
    return 0;
}</code></pre>

</details>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy;  <a href="https://wiki.verly-badcw.top" target="_blank">wiki.verly-badcw.top</a>
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.d151b584.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../../../search/main.js"></script>
      
    
  </body>
</html>