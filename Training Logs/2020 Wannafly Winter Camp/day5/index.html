
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://wiki.badcw.cn/Training%20Logs/2020%20Wannafly%20Winter%20Camp/day5/">
      
      <link rel="icon" href="../../../favicon.ico">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Day5 - Team Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.1dff34a1.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#ffffff">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="white" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Team Wiki" class="md-header__button md-logo" aria-label="Team Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.35 10.03A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.03A6.004 6.004 0 0 0 0 14a6 6 0 0 0 6 6h13a5 5 0 0 0 5-5c0-2.64-2.05-4.78-4.65-4.97Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Team Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Day5
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Team Wiki" class="md-nav__button md-logo" aria-label="Team Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.35 10.03A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.03A6.004 6.004 0 0 0 0 14a6 6 0 0 0 6 6h13a5 5 0 0 0 5-5c0-2.64-2.05-4.78-4.65-4.97Z"/></svg>

    </a>
    Team Wiki
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          主页
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="主页" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          主页
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        赛季列表
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          个人页面
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="个人页面" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          个人页面
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Personal%20Page/Verly/" class="md-nav__link">
        Verly
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Personal%20Page/badcw/" class="md-nav__link">
        badcw
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          关于
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="关于" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          关于
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../About/About/" class="md-nav__link">
        About
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    上午讲课
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    下午比赛
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to-do-list" class="md-nav__link">
    To-do list
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-alternative-accounts" class="md-nav__link">
    A. Alternative Accounts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#e-matching-problem" class="md-nav__link">
    E. Matching Problem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#g-cryptographically-secure-pseudorandom-number-generator" class="md-nav__link">
    G. Cryptographically Secure Pseudorandom Number Generator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#j-xor-on-figures" class="md-nav__link">
    J. Xor on Figures
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>Day5</h1>

<h2 id="_1">上午讲课<a class="headerlink" href="#_1" title="Permanent link">Link</a></h2>
<p>来自分块爷 <code>nzhtl1477</code> 的三百页分块 ppt 把人都讲晕了</p>
<h2 id="_2">下午比赛<a class="headerlink" href="#_2" title="Permanent link">Link</a></h2>
<p>总之越打越菜，来自 dls 的迷惑题目</p>
<table>
<thead>
<tr>
<th>Name</th>
<th align="center">Date</th>
<th align="center">Solved</th>
<th align="center">A</th>
<th align="center">B</th>
<th align="center">C</th>
<th align="center">D</th>
<th align="center">E</th>
<th align="center">F</th>
<th align="center">G</th>
<th align="center">H</th>
<th align="center">I</th>
<th align="center">J</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://pintia.cn/problem-sets/1217641604302602240">2020 CCPC Wannafly Winter Camp Day5 (Div.1&amp;2)</a></td>
<td align="center">2020/1/16</td>
<td align="center">4/10</td>
<td align="center">O</td>
<td align="center">.</td>
<td align="center">.</td>
<td align="center">.</td>
<td align="center">O</td>
<td align="center">.</td>
<td align="center">O</td>
<td align="center">.</td>
<td align="center">.</td>
<td align="center">O</td>
</tr>
</tbody>
</table>
<h2 id="to-do-list">To-do list<a class="headerlink" href="#to-do-list" title="Permanent link">Link</a></h2>
<p><code>G\J\I</code></p>
<h2 id="a-alternative-accounts">A. Alternative Accounts<a class="headerlink" href="#a-alternative-accounts" title="Permanent link">Link</a></h2>
<p>有至多三场比赛，n 个账号，一个人可能有多个账号，但是一个人在一场比赛中最多使用一个账号，求最少的人数</p>
<p>首先有 8 种账号，按照三场比赛来进行二进制压位，那么对于任意按位与为 0 的账号都可能属于同一个人，另外可以分析出如果 x 个账号属于同一个人，那么总量将减少 x - 1，所以对任意账号其实只要找出可行对能让它减少，本身并不带权，也就是说不存在优先性问题。所以考虑贪心的减掉所有的边即可。顺序先是减去内部三元环，再减去一对二的边，最后减去内部边即可完全减掉。</p>
<p>??? note &ldquo;Code&rdquo;
    ```cpp
    #include <bits/stdc++.h></p>
<pre class="codehilite"><code class="linenums">using namespace std;
typedef long long ll;

const int maxn = 1e5 + 10;
int a[maxn], s[10];

int main()
{
    int n, k;
    scanf(&quot;%d%d&quot;, &amp;n, &amp;k);
    for(int i = 0; i &lt; k; i ++)
    {
        int t, x;
        scanf(&quot;%d&quot;, &amp;t);
        while(t --)
        {
            scanf(&quot;%d&quot;, &amp;x);
            a[x] |= (1 &lt;&lt; i);
        }
    }
    for(int i = 1; i &lt;= n; i ++) s[a[i]] ++;
    int res = n;
    res -= s[0];
    for(int i = 1; i &lt;= 4; i *= 2)
    {
        int x = i, y = 7 ^ i;
        int tmp = min(s[x], s[y]);
        res -= tmp;
        s[x] -= tmp, s[y] -= tmp;
    }
    int tmp = min({s[1], s[2], s[4]});
    res -= 2 * tmp;
    s[1] -= tmp, s[2] -= tmp, s[4] -= tmp;
    for(int i = 1; i &lt;= 4; i *= 2)
    {
        for(int j = i * 2; j &lt;= 4; j *= 2)
        {
            int tmp = min(s[i], s[j]);
            res -= tmp;
            s[i] -= tmp, s[j] -= tmp;
        }
    }
    printf(&quot;%d\n&quot;, res);
    return 0;
}
```
</code></pre>

<h2 id="e-matching-problem">E. Matching Problem<a class="headerlink" href="#e-matching-problem" title="Permanent link">Link</a></h2>
<p>给 a，b 两个序列，b 序列长度为 4，求 a 的子序列有多少个满足和 b 的每个等于、不等关系一样</p>
<p>分类讨论即可，代码有点长</p>
<p>??? note &ldquo;Code&rdquo;
    ```cpp
    #include <bits/stdc++.h>
    using namespace std;
    const int N=310;
    typedef long long LL;
    int n,m;
    int a[N],b[N];
    int hx[N],hy[N];
    map<int,int>mp;int tt;</p>
<pre class="codehilite"><code class="linenums">int findf(int x){
    int l=1,r=hy[0];
    while(l&lt;=r){
        int mid=l+r&gt;&gt;1;
        if(hy[mid]&gt;x)r=mid-1;
        else if(hy[mid]&lt;x)l=mid+1;
        else return mid;
    }
}

LL cnt[N],sum[N],cnt2[N],cnt3[N];

int judge(){
    for(int i=1;i&lt;=4;i++)cnt[b[i]]++;
    LL mx=0;
    for(int i=1;i&lt;=4;i++)mx=max(mx,cnt[i]);
    for(int i=1;i&lt;=4;i++)cnt[i]=0;
    return mx;
}

void solve1(){
    for(int i=1;i&lt;=n;i++)cnt[a[i]]++;
    LL ans=0;m=hy[0];
    for(int i=1;i&lt;=m;i++)sum[i]=cnt[i]+sum[i-1];
    for(int i=1;i&lt;=m;i++){
        for(int j=i+1;j&lt;=m;j++){
            for(int k=j+1;k&lt;=m;k++){
                ans+=cnt[i]*cnt[j]*cnt[k]*(sum[m]-sum[k]);
            }
        }
    }
    printf(&quot;%lld\n&quot;,ans);
}


void solve2(){
    int idxa=-1,idxb=-1,mx=0,mf;m=hy[0];
    for(int i=1;i&lt;=4;i++){
        cnt[b[i]]++;
        if(cnt[b[i]]&gt;mx){
            mx=cnt[b[i]];mf=b[i];
        }
    }
    for(int i=1;i&lt;=4;i++)cnt[b[i]]=0;
    for(int i=1;i&lt;=4;i++){
        if(b[i]==mf)continue;
        if(idxa==-1)idxa=i;
        else idxb=i;
    }
    LL ans=0;
    for(int i=1;i&lt;=n;i++){
        for(int j=i+1;j&lt;=n;j++){
            if(a[i]!=a[j])continue;
            for(int k=1;k&lt;=m;k++)cnt[k]=0;
            for(int k=1;k&lt;=m;k++)cnt2[k]=0;
            if(idxb==idxa+1){
                if(idxa==1){
                    for(int k=1;k&lt;i;k++)if(a[k]!=a[i])cnt[a[k]]++;
                }else if(idxa==2){
                    for(int k=i+1;k&lt;j;k++)if(a[k]!=a[i])cnt[a[k]]++;
                }else{
                    for(int k=j+1;k&lt;=n;k++)if(a[k]!=a[i])cnt[a[k]]++;
                }
                if(b[idxa]==b[idxb]){
                    for(int k=1;k&lt;=m;k++)if(k!=a[i])ans+=(cnt[k]+cnt2[k])*(cnt[k]+cnt2[k]-1)/2; 
                }else{
                    LL sum1=0,sum2=0;
                    for(int k=1;k&lt;=m;k++)if(k!=a[i])sum1+=cnt[k];
                    for(int k=1;k&lt;=m;k++)if(k!=a[i])sum2+=(sum1-cnt[k])*cnt[k];
                    ans+=sum2/2;
                }
            }else{
                if(idxa==1){
                    for(int k=1;k&lt;i;k++)if(a[k]!=a[i])cnt[a[k]]++;
                }else if(idxa==2){
                    for(int k=i+1;k&lt;j;k++)if(a[k]!=a[i])cnt[a[k]]++;
                }

                if(idxb==3){
                    for(int k=i+1;k&lt;j;k++)if(a[k]!=a[i])cnt2[a[k]]++;
                }else if(idxb==4){
                    for(int k=j+1;k&lt;=n;k++)if(a[k]!=a[i])cnt2[a[k]]++;
                }

                if(b[idxa]==b[idxb]){

                    for(int k=1;k&lt;=m;k++){
                        if(k!=a[i])ans+=cnt[k]*cnt2[k];
                    }
                }else{
                    LL sum1=0;
                    for(int k=1;k&lt;=m;k++)if(k!=a[i])sum1+=cnt2[k];

                    for(int k=1;k&lt;=m;k++){
                        ans+=cnt[k]*(sum1-cnt2[k]);
                    }
                }
            }
        }
    }
    printf(&quot;%lld\n&quot;,ans);
}

void solve3(){
    int idx=-1,mx=0,mf;m=hy[0];
    for(int i=1;i&lt;=4;i++){
        cnt[b[i]]++;
        if(cnt[b[i]]&gt;mx){
            mx=cnt[b[i]];mf=b[i];
        }
    }
    for(int i=1;i&lt;=4;i++)cnt[b[i]]=0;
    for(int i=1;i&lt;=4;i++){
        if(b[i]==mf)continue;
        idx=i;break;
    }
    LL ans=0;
    for(int i=1;i&lt;=n;i++){
        for(int j=i+1;j&lt;=n;j++){
            if(a[i]!=a[j])continue;
            LL sum1=i-1,sum2=j-i-1,sum3=n-j;
            for(int k=1;k&lt;=m;k++)cnt[k]=cnt2[k]=cnt3[k]=0;

            for(int k=1;k&lt;i;k++)cnt[a[k]]++;
            for(int k=i+1;k&lt;j;k++)cnt2[a[k]]++;
            for(int k=j+1;k&lt;=n;k++)cnt3[a[k]]++;

            //aaab
            if(idx==4)ans+=cnt[a[i]]*(sum3-cnt3[a[i]]);
            //aaba
            if(idx==3)ans+=cnt[a[i]]*(sum2-cnt2[a[i]]);
            //abaa
            if(idx==2)ans+=cnt3[a[i]]*(sum2-cnt2[a[i]]);
            //baaa
            if(idx==1)ans+=(sum1-cnt[a[i]])*cnt3[a[i]];

        }
    }
    printf(&quot;%lld\n&quot;,ans);
}


void solve4(){
    for(int i=1;i&lt;=n;i++)cnt[a[i]]++;
    LL ans=0;m=hy[0];
    for(int i=1;i&lt;=m;i++)if(cnt[a[i]]&gt;=4)ans+=(cnt[a[i]]* (cnt[a[i]]-1) *(cnt[a[i]]-2)*(cnt[a[i]]-3) )/24;
    printf(&quot;%lld\n&quot;,ans);
}

int main(){
#ifdef WK
    freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);
#endif
    scanf(&quot;%d&quot;,&amp;n);
    for(int i=1;i&lt;=n;i++)scanf(&quot;%d&quot;,&amp;a[i]),hx[++hx[0]]=a[i];
    for(int i=1;i&lt;=4;i++){
        scanf(&quot;%d&quot;,&amp;b[i]);
        if(!mp[b[i]])mp[b[i]]=++tt;
        b[i]=mp[b[i]];
    }

    sort(hx+1,hx+1+hx[0]);
    hy[++hy[0]]=hx[1];
    for(int i=2;i&lt;=hx[0];i++)if(hx[i]!=hx[i-1])hy[++hy[0]]=hx[i];

    for(int i=1;i&lt;=n;i++)a[i]=findf(a[i]);
    int st=judge();
    switch(st){
        case 1:solve1();return 0;
        case 2:solve2();return 0;
        case 3:solve3();return 0;
        case 4:solve4();return 0;
    }
    return 0;
} 
```
</code></pre>

<h2 id="g-cryptographically-secure-pseudorandom-number-generator">G. Cryptographically Secure Pseudorandom Number Generator<a class="headerlink" href="#g-cryptographically-secure-pseudorandom-number-generator" title="Permanent link">Link</a></h2>
<p>??? note &ldquo;Code&rdquo;
    ```cpp
    #include <bits/stdc++.h>
    using namespace std;
    const int N=2000010;
    typedef long long LL;
    int n,m;LL p;
    LL inv[N];
    LL v[N],v2[N];</p>
<pre class="codehilite"><code class="linenums">int main(){
#ifdef WK
    freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);
    freopen(&quot;out.txt&quot;,&quot;w&quot;,stdout);
#endif
    int T;scanf(&quot;%d&quot;,&amp;T);
    while(T--){
        scanf(&quot;%lld&quot;,&amp;p);
        LL mn=p+1;
        n=0;m=0;
        inv[1]=1;
        for(int i=2,sz=min(N,(int)p);i&lt;sz;i++){
            inv[i]=(p-p/i)*inv[p%i]%p;
            if(inv[i]&lt;mn){
                n++;
                v[n]=i;
                v2[n]=inv[i];
                mn=inv[i];
                if(i&gt;=mn)break;
            }
        }
        m=n;
        for(int i=m-2;i&gt;=1;i--){
            n++;
            v[n]=v2[i];
            v2[n]=v[i];
        }
        printf(&quot;%d\n&quot;,n);
        for(int i=1;i&lt;=n;i++)printf(&quot;%lld %lld\n&quot;,v[i],v2[i]);
    }
    return 0;
} 
```
</code></pre>

<h2 id="j-xor-on-figures">J. Xor on Figures<a class="headerlink" href="#j-xor-on-figures" title="Permanent link">Link</a></h2>
<p>??? note &ldquo;Code&rdquo;
    ```cpp
    #include <bits/stdc++.h></p>
<pre class="codehilite"><code class="linenums">using namespace std;
typedef long long ll;

const int mod = 1e9 + 7;

struct Base
{
#define TYPE bitset&lt;1024&gt;
    static const int len = 1024;
    bool rel; int sz;
    TYPE a[len];

    TYPE &amp;operator[](int x) {
        return a[x];
    }

    TYPE operator[](int x) const {
        return a[x];
    }

    void insert(bitset&lt;1024&gt; t)
    {
        for(int i = len - 1; i &gt;= 0; i --) 
        {
            if(!(t[i] == 1)) continue;
            if(a[i].count()) t ^= a[i];
            else 
            {
                for(int j = 0; j &lt; i; j ++) if(t[j]) t ^= a[j];
                for(int j = i + 1; j &lt; len; j ++) if(a[j][i] == 1) a[j] ^= t;
                a[i] = t;
                ++ sz;
                return;
            }
        }
        rel = true;
    }
}solve;

ll qp(ll a, ll n)
{
    ll ans = 1, base = a;
    while(n)
    {
        if(n &amp; 1) (ans *= base) %= mod;
        (base *= base) %= mod;
        n &gt;&gt;= 1;
    }
    return ans;
}

char s[50][50];

int main()
{
    int k;
    scanf(&quot;%d&quot;, &amp;k);
    int n = 1 &lt;&lt; k;
    for(int i = 0; i &lt; n; i ++)
        scanf(&quot;%s&quot;, s[i]);
    for(int x = 0; x &lt; n; x ++)
    {
        for(int y = 0; y &lt; n; y ++)
        {
            bitset&lt;1024&gt; tmp;
            for(int i = 0; i &lt; n; i ++)
            {
                for(int j = 0; j &lt; n; j ++)
                {
                    int dx = (i + x) % n, dy = (j + y) % n;
                    int id = dx * n + dy;
                    if(s[i][j] == '1') tmp[id] = 1;
                }
            }
            solve.insert(tmp);
        }
    }
    printf(&quot;%lld\n&quot;, qp(2, solve.sz));
    return 0;
}
```
</code></pre>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy;  <a href="https://wiki.badcw.cn" target="_blank">wiki.badcw.cn</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c99f48ec.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../../../search/main.js"></script>
      
    
  </body>
</html>